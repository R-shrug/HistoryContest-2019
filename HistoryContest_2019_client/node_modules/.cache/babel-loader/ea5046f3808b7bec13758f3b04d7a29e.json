{"ast":null,"code":"var _jsxFileName = \"E:\\\\projects\\\\HistoryContest-2019\\\\historycontest2019\\\\src\\\\Components\\\\LoginModal\\\\LoginModal.js\";\nimport React from 'react';\nimport \"antd/dist/antd.css\";\nimport { Icon, Button, Input, Modal, message, Dropdown, Menu } from 'antd';\n\nclass LoginModal extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      visible: true,\n      attemp: \"0\",\n      name: \"\",\n      username: '',\n      password: '',\n      toDo: \"登录\"\n    };\n    this.ToLogin = this.ToLogin.bind(this);\n    this.close = this.close.bind(this);\n    this.signin = this.signin.bind(this);\n    this.ToSignin = this.ToSignin.bind(this);\n  }\n\n  componentWillUnmount() {\n    this.setState({\n      visible: false\n    });\n    this.state.username = '';\n    this.state.password = '';\n  }\n\n  ToLogin() {\n    let that = this;\n    let username = this.state.username;\n    let password = this.state.password;\n    let identity = this.state.attemp;\n\n    if (isNaN(username)) {\n      message.warn(\"输入非学号哟\");\n      return;\n    } //暂时的登陆函数\n    //最后要区分登陆请求\n\n\n    fetch('http://' + that.props.state.host + '/login', {\n      method: 'POST',\n      mode: 'cors',\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      },\n      body: JSON.stringify({\n        username: username,\n        password: password,\n        identity: identity\n      })\n    }).then(res => {\n      return res.json();\n    }).then(data => {\n      if (data.status == 404) {\n        message.error(\"学号不存在\");\n      } else if (data.status == 204) {\n        message.error(\"用户名或密码错误\");\n      } else {}\n    }); //学生登陆成功\n\n    console.log(\"login\");\n    message.success(\"登录成功！\");\n    this.props.setState({\n      isWelcome: false,\n      isStudent: true,\n      isLogin: true,\n      username: this.state.username\n    });\n  }\n\n  ToSignin() {\n    //暂时的注册函数\n    this.props.setState({\n      isWelcome: false,\n      isStudent: true,\n      isLogin: true\n    });\n  }\n\n  close() {\n    this.setState({\n      visible: false\n    });\n    this.props.close();\n  }\n\n  signin() {\n    this.setState({\n      toDo: \"注册\"\n    });\n  }\n\n  render() {\n    let login = React.createElement(\"div\", {\n      id: \"modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 78\n      },\n      __self: this\n    }, React.createElement(Modal, {\n      title: React.createElement(Dropdown, {\n        overlay: React.createElement(Menu, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 82\n          },\n          __self: this\n        }, React.createElement(Menu.Item, {\n          key: \"1\",\n          onClick: () => this.setState({\n            attemp: \"0\"\n          }),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 83\n          },\n          __self: this\n        }, \"\\u5B66\\u751F\"), React.createElement(Menu.Item, {\n          key: \"2\",\n          onClick: () => this.setState({\n            attemp: \"2\"\n          }),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84\n          },\n          __self: this\n        }, \"\\u8F85\\u5BFC\\u5458\"), React.createElement(Menu.Item, {\n          key: \"3\",\n          onClick: () => this.setState({\n            attemp: \"1\"\n          }),\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85\n          },\n          __self: this\n        }, \"\\u7BA1\\u7406\\u5458\")),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81\n        },\n        __self: this\n      }, React.createElement(Button, {\n        type: \"defult\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, React.createElement(Icon, {\n        type: \"down\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }), this.state.attemp)),\n      visible: this.state.visible,\n      onOk: this.StudentToLogin,\n      onCancel: this.close,\n      footer: [React.createElement(Button, {\n        key: \"\\u8FD4\\u56DE\",\n        type: \"defult\",\n        onClick: this.close,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 96\n        },\n        __self: this\n      }, \"\\u8FD4\\u56DE\"), React.createElement(Button, {\n        key: \"\\u767B\\u5F55\",\n        type: \"primary\",\n        onClick: this.ToLogin,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99\n        },\n        __self: this\n      }, React.createElement(Icon, {\n        type: \"check-circle\",\n        theme: \"twoTone\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100\n        },\n        __self: this\n      }), \"\\u767B\\u5F55\")],\n      visible: this.state.visible,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 79\n      },\n      __self: this\n    }, React.createElement(Input, {\n      id: \"username\",\n      addonBefore: \" \\u8D26\\u6237 \",\n      placeholder: \"\\u516B\\u4F4D\\u5B66\\u53F7\",\n      allowClear: true,\n      onChange: (x, v) => {\n        this.setState({\n          username: v\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }), React.createElement(Input.Password, {\n      id: \"password\",\n      addonBefore: \" \\u5BC6\\u7801 \",\n      placeholder: \"\\u4E00\\u5361\\u901A\\u53F7\\u7801\",\n      allowClear: true,\n      onChange: (x, v) => {\n        this.setState({\n          password: v\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }, \" \", React.createElement(\"br\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 109\n      },\n      __self: this\n    }), \"\\u975E\\u7279\\u6B8A\\u60C5\\u51B5\\u4E0D\\u7528\\u6CE8\\u518C\\u54E6~\\xA0\\xA0\", React.createElement(\"a\", {\n      onClick: this.signin,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 110\n      },\n      __self: this\n    }, \"\\u6CE8\\u518C\"))));\n    let sign = React.createElement(\"div\", {\n      id: \"modal\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, React.createElement(Modal, {\n      title: \"\\u5B66\\u751F\\u6CE8\\u518C \",\n      visible: this.state.visible,\n      onOk: this.StudentToLogin,\n      onCancel: this.close,\n      footer: [React.createElement(Button, {\n        key: \"\\u8FD4\\u56DE\",\n        type: \"defult\",\n        onClick: this.close,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126\n        },\n        __self: this\n      }, \"\\u8FD4\\u56DE\"), React.createElement(Button, {\n        key: \"\\u6CE8\\u518C\",\n        type: \"primary\",\n        onClick: this.ToSignin,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129\n        },\n        __self: this\n      }, \"\\u6CE8\\u518C\")],\n      visible: this.state.visible,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, React.createElement(Input, {\n      id: \"name\",\n      addonBefore: \" \\u59D3\\u540D \",\n      placeholder: \"\\u4F60\\u7684\\u59D3\\u540D\",\n      allowClear: true,\n      onChange: (x, v) => {\n        this.setState({\n          name: v\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136\n      },\n      __self: this\n    }), React.createElement(Input, {\n      id: \"username\",\n      addonBefore: \" \\u8D26\\u6237 \",\n      placeholder: \"\\u5B66\\u53F7\",\n      allowClear: true,\n      onChange: (x, v) => {\n        this.setState({\n          username: v\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137\n      },\n      __self: this\n    }), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138\n      },\n      __self: this\n    }), React.createElement(Input.Password, {\n      id: \"password\",\n      addonBefore: \" \\u5BC6\\u7801 \",\n      placeholder: \"\\u4E00\\u5361\\u901A\\u53F7\\u7801\",\n      allowClear: true,\n      onChange: (x, v) => {\n        this.setState({\n          password: v\n        });\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139\n      },\n      __self: this\n    })));\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144\n      },\n      __self: this\n    }, this.state.toDo == \"登录\" ? login : sign);\n  }\n\n}\n\nexport default LoginModal;","map":{"version":3,"sources":["E:\\projects\\HistoryContest-2019\\historycontest2019\\src\\Components\\LoginModal\\LoginModal.js"],"names":["React","Icon","Button","Input","Modal","message","Dropdown","Menu","LoginModal","Component","constructor","props","state","visible","attemp","name","username","password","toDo","ToLogin","bind","close","signin","ToSignin","componentWillUnmount","setState","that","identity","isNaN","warn","fetch","host","method","mode","headers","body","JSON","stringify","then","res","json","data","status","error","console","log","success","isWelcome","isStudent","isLogin","render","login","StudentToLogin","x","v","sign"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport \"antd/dist/antd.css\"\r\nimport {Icon,Button,Input,Modal,message,Dropdown,Menu} from 'antd';\r\n\r\nclass LoginModal extends React.Component{\r\n  constructor(props){\r\n      super(props);\r\n      this.state={\r\n          visible:true,\r\n          attemp:\"0\",\r\n          name:\"\",\r\n          username:'',\r\n          password:'',\r\n          toDo:\"登录\"\r\n      }\r\n      this.ToLogin=this.ToLogin.bind(this);\r\n      this.close=this.close.bind(this);\r\n      this.signin=this.signin.bind(this);\r\n      this.ToSignin=this.ToSignin.bind(this);\r\n  }\r\n  componentWillUnmount(){\r\n      this.setState({visible:false});\r\n      this.state.username='';\r\n      this.state.password='';\r\n  }\r\n  ToLogin(){\r\n      let that=this;\r\n      let username=this.state.username;\r\n      let password=this.state.password;\r\n      let identity=this.state.attemp;\r\n      if(isNaN(username)) {\r\n          message.warn(\"输入非学号哟\");\r\n          return;\r\n      }\r\n      //暂时的登陆函数\r\n      //最后要区分登陆请求\r\n      fetch('http://'+that.props.state.host+'/login',{\r\n        method: 'POST',\r\n        mode: 'cors',\r\n        headers: {\r\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n        },\r\n        body:JSON.stringify({   \r\n            username:username,\r\n            password:password,\r\n            identity:identity\r\n        })}).then(\r\n            res=>{return res.json()}\r\n        ).then(data=>{\r\n            if(data.status==404){\r\n                message.error(\"学号不存在\");\r\n            }\r\n            else if(data.status==204){\r\n                message.error(\"用户名或密码错误\");\r\n            }\r\n            else{\r\n\r\n            }\r\n        })\r\n \r\n      //学生登陆成功\r\n      console.log(\"login\");\r\n      message.success(\"登录成功！\");\r\n      this.props.setState({isWelcome:false,isStudent:true,isLogin:true,username:this.state.username});\r\n  }\r\n  ToSignin(){\r\n      //暂时的注册函数\r\n      this.props.setState({isWelcome:false,isStudent:true,isLogin:true});\r\n  }\r\n  close(){\r\n      this.setState({visible:false});\r\n      this.props.close();\r\n  }\r\n  signin(){\r\n      this.setState({toDo:\"注册\"});\r\n  }\r\n  render(){ \r\n      let login=<div id='modal'>\r\n      <Modal \r\n          title={\r\n       <Dropdown overlay={\r\n          <Menu>\r\n              <Menu.Item key=\"1\" onClick={()=>this.setState({attemp:\"0\"})}>学生</Menu.Item>\r\n              <Menu.Item key=\"2\" onClick={()=>this.setState({attemp:\"2\"})}>辅导员</Menu.Item>\r\n              <Menu.Item key=\"3\" onClick={()=>this.setState({attemp:\"1\"})}>管理员</Menu.Item>\r\n          </Menu >}>\r\n          <Button type=\"defult\">\r\n              <Icon type=\"down\" />\r\n              {this.state.attemp}\r\n          </Button>\r\n      </Dropdown>}\r\n          visible={this.state.visible}\r\n          onOk={this.StudentToLogin}\r\n          onCancel={this.close}\r\n          footer={[\r\n              <Button key=\"返回\" type=\"defult\" onClick={this.close}>\r\n                返回\r\n              </Button>,\r\n              <Button key=\"登录\" type=\"primary\" onClick={this.ToLogin}>\r\n                  <Icon type=\"check-circle\" theme=\"twoTone\" />\r\n                登录\r\n              </Button>\r\n            ]}\r\n          visible={this.state.visible}\r\n      >\r\n          <Input id=\"username\"addonBefore=\" 账户 \"placeholder=\"八位学号\" allowClear onChange={(x,v)=>{this.setState({username:v})}}></Input>\r\n          <p></p>\r\n          <Input.Password id=\"password\"addonBefore=\" 密码 \" placeholder=\"一卡通号码\" allowClear onChange={(x,v)=>{this.setState({password:v})}} />\r\n          <p > <br></br>非特殊情况不用注册哦~&nbsp;&nbsp;\r\n          <a onClick={this.signin}>\r\n            注册\r\n          </a>\r\n          </p>\r\n\r\n      </Modal>\r\n      </div>\r\n\r\n      \r\n      let sign=<div id='modal'>\r\n      <Modal \r\n          title=\"学生注册 \"\r\n          visible={this.state.visible}\r\n          onOk={this.StudentToLogin}\r\n          onCancel={this.close}\r\n          footer={ [\r\n              <Button key=\"返回\" type=\"defult\"  onClick={this.close}>\r\n                返回\r\n              </Button>,\r\n              <Button key=\"注册\" type=\"primary\" onClick={this.ToSignin}>\r\n                注册\r\n              </Button>\r\n          ]}\r\n          visible={this.state.visible}\r\n      >\r\n          <Input id=\"name\"addonBefore=\" 姓名 \"placeholder=\"你的姓名\" allowClear onChange={(x,v)=>{this.setState({name:v})}}></Input>\r\n          <p></p>\r\n          <Input id=\"username\"addonBefore=\" 账户 \"placeholder=\"学号\" allowClear onChange={(x,v)=>{this.setState({username:v})}}></Input>\r\n          <p></p>\r\n          <Input.Password id=\"password\"addonBefore=\" 密码 \" placeholder=\"一卡通号码\" allowClear onChange={(x,v)=>{this.setState({password:v})}} />\r\n\r\n      </Modal>\r\n      </div>\r\n      return(\r\n          <React.Fragment>\r\n              {this.state.toDo==\"登录\"?login:sign}\r\n          </React.Fragment>\r\n      )\r\n          }\r\n  }\r\n  \r\n  export default LoginModal;"]},"metadata":{},"sourceType":"module"}